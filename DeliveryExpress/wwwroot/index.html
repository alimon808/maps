<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Delivery Express</title>
    <script src='https://api.tiles.mapbox.com/mapbox.js/v2.2.4/mapbox.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox.js/v2.2.4/mapbox.css' rel='stylesheet' />
    <style>
        body {
            margin: 0;
            padding:0;
        }

        #map {
            position: absolute; 
            top: 0; 
            bottom: 0; 
            width: 100%;
        }
    </style>
    <script src="js/markers.js"></script>
    <script src="js/paths.js"></script>
    <script>

        function setupMap() {
            L.mapbox.accessToken = 'pk.eyJ1IjoiYWxpbW9uIiwiYSI6ImNpcDdzeWF3cjAxNmxzeG5yeHRteTAxZXgifQ.7MJPz9HOpjitcYyKHk7GgQ';
            window.map = L.mapbox.map('map', null, { minZoom: 11 });

            var layers = {
                map: L.mapbox.tileLayer('mapbox.streets'),
                terrain: L.mapbox.tileLayer('mapbox.satellite')
            };

            layers.map.addTo(map);
            L.control.layers(layers).addTo(map);

            L.control.scale({ imperial: false, position: "bottomright" }).addTo(map);
            map.addControl(L.mapbox.infoControl({ position: "bottomleft" }));
            map.removeControl(map.attributionControl);
            map.setView([-41.2889, 174.7772], 12);
        }

        function showMarkers() {
            var icons = {
                "Truck": L.icon({
                    iconUrl: "img/truck.png",
                    iconSize: [30, 15],
                    className: "icon"
                }),
                "Van": L.icon({
                    iconUrl: "img/van.png",
                    iconSize: [30, 15],
                    className: "icon"
                }),
                "Scooter": L.icon({
                    iconUrl: "img/scooter.png",
                    iconSize: [25, 15],
                    className: "icon"
                })
            };

            var layer = L.geoJson(markers, {
                pointToLayer: function (feature, latLng) {
                    return L.marker(latLng, {
                        title: feature.properties.title,
                        icon: icons[feature.properties.description]
                    });
                },
                onEachFeature: function (feature, layer) {
                    layer.bindPopup(feature.properties.title);
                }
            });

            layer.addTo(map);
        }

        window.onload = function () {
            setupMap();
            showMarkers();

            var layer = L.geoJson(paths, { color: "#ff8c00", weight: 3, opacity: 0.7 });
            layer.addTo(map);

        };

    </script>
</head>
<body>
    <div id="map"></div>
</body>
</html>